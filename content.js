// Brand Name,2023 FINAL SCORE
const data = `Abercrombie & Fitch,83.25
Adidas,140
Aeropostale,7.5
AJIO,20
ALDI Nord,78
ALDI SOUTH,86
ALDO,35.75
Amazon,64.25
American Eagle,53.5
ANTA,0.25
Anthropologie,32.5
Aritzia,54.25
Armani,95.75
Asda,69.75
ASICS,113.25
ASOS,125
Balenciaga,126.25
Bally,82.75
Banana Republic,120.25
BCBGMAXAZRIA,3.25
Beanpole,17
Belle,0
Bershka,124.5
Big Bazaar - ffb,0
Big W,97
Billabong,15.75
Bloomingdale's,16.5
Bonprix,93
boohoo,60.75
Bosideng,0.25
Bottega Veneta,126.25
Brooks Sport,90.25
Brunello Cucinelli,34.75
Buckle,10
Burberry,95.75
Burlington,36
C&A,169
Calvin Klein,120.25
Calzedonia,156.25
Canada Goose,38.75
Carhartt,18.5
Carolina Herrera,39.25
CAROLL,11.5
Carrefour,58.75
Carter's,61.25
CELINE,75.5
celio,1.75
Champion,93.75
Chanel,26.5
Chico's,34.25
Chloé,107
Clarks,42.75
COACH,103.75
Columbia Sportswear,91.75
Converse,124.75
Cortefiel,51.25
Costco,24.25
Cotton On,54.75
Decathlon,64.5
Deichmann,5.5
Desigual,61.5
Dick's Sporting Goods,68.5
Diesel,47.25
Dillard's,8.25
Dior,73
Disney,55
DKNY,1.5
Dolce & Gabbana,4.25
Dr. Martens,88
Dressmann,161.25
DSW,17.25
Eddie Bauer,11.5
El Corte Inglés,59.5
Ermenegildo Zegna,81.5
Esprit,112
Express,15.25
Fabletics,4
Falabella,26.5
Famous Footwear,22.75
Fanatics,44.25
Fashion Nova,0.75
Fendi,145.5
Fila,37.25
Fjällräven,100
Foot Locker,23
Foschini,44.75
Fossil,39.75
Free People,32.5
Fruit of the Loom,83.75
Furla,11.75
G-Star RAW,122.5
Gap,120.25
Gerry Weber,20.25
Gildan,133.75
GU,126.5
Gucci,199.25
GUESS,77.25
Gymshark,67
H&M,177.75
Hanes,93.75
Heilan Home,0
Helly Hansen,76
HEMA,59.25
Hermès,69.75
Hollister Co.,83.25
Hudson's Bay,21.5
Hugo Boss,137
Intimissimi,156.25
Ito-Yokado,27.25
Jack & Jones,102
Jack Wolfskin,61.5
JD Sports,73.5
Jil Sander,44.25
Jockey,5
Joe Fresh,44.5
John Lewis,80
Jordan,124.75
K-Way,0
Kate Spade,101.75
Kathmandu,72.25
Kaufland,29
Kiabi,40.25
KiK,41.5
Kmart,16
Kmart Australia,191
Kohl's,41.75
KOOVS,0
La Redoute,31.5
Lacoste,93.75
Lands' End,31
LC Waikiki,9
Levi Strauss & Co,151
Li-Ning,21.5
Lidl,62.5
Lindex,108.75
LL Bean,21
Longchamp,6
Louis Vuitton,72
Lululemon,129.75
Macy's,16.5
Mammut,86.25
Mango,122
Marc Jacobs,71
Marks & Spencer,95.25
Marni,42.25
Massimo Dutti,124.5
Matalan,73.5
Max,2.25
Max Mara,0.75
Merrell,20.25
Metersbonwe,0
Mexx,0
Michael Kors,58.5
Miu Miu,85.5
Mizuno,44.75
Moncler,66.5
Monoprix,44
Morrisons,72
MRP,26.75
Muji,70.25
New Balance,113.75
New Look,105
New Yorker,0.75
Next,90.5
Nike,124.75
Nine West,1.5
Nordstrom,65.25
Old Navy,120.25
Otto,49.25
OVS,207.5
Paris,61.75
Patagonia,99.5
Pepe Jeans,6
Pimkie,45.5
Prada,85.5
PrettyLittleThing,60.75
Primark,99.25
Prisma,56
Pull&Bear,124.5
Puma,166
Quiksilver,15.75
Ralph Lauren,134.75
Reebok,3
REI,53.75
Reliance Trends,25.25
Reserved,49.5
REVOLVE,4.25
River Island,78.75
Romwe,6.5
Ross Dress for Less,15.25
Roxy,15.75
Russell Athletic,83.75
s.Oliver,106.5
Sainsbury's,126.5
SAINT LAURENT,126.25
Saks Fifth Avenue,23.5
Salvatore Ferragamo,60
Sandro,54.25
Savage X Fenty,0
Semir,0
SHEIN,16.5
Shimamura,10
Skechers,16.25
Speedo,117.75
Splash,1
Sports Direct,17.5
Steve Madden,32.5
Stradivarius,124.5
Superdry,121.5
Takko,17.75
Target,93
Target Australia,191
Tchibo,107
Ted Baker,64.5
Tesco,119.75
Tezenis,156.25
The Children's Place,42.25
The North Face,163.75
The Warehouse,42.75
Timberland,163.75
TJ Maxx,32.75
Tod's,22.25
Tom Ford,0.5
Tom Tailor,125.5
Tommy Bahama,24
Tommy Hilfiger,123.75
TOPVALU COLLECTION,32.75
Tory Burch,1.25
Triumph,18
Truworths,18.5
UGG,141.75
Under Armour,69.25
Uniqlo,126.5
United Arrows,41.5
United Colors of Benetton,182.5
Urban Outfitters,32.5
Valentino,43.75
Van Heusen,0
Vans,162.75
Vero Moda,102
Versace,58.75
Very,67.25
Victoria's Secret,47.25
Walmart,57
Woolworths South Africa,73.5
Wrangler,82.25
Youngor,0
Zalando,99.75
Zara,124.5
Zeeman,134.5`;


class Brand {
    constructor(name, score) {
        this.name = name;
        this.score = score;
    }
};


const parse = () => {
    let entries = [];
    const lines = data.split("\n");
    for (const line of lines) {
        const [name, score] = line.split(",");
        const brand = new Brand(name, score);
        entries.push(brand);
    }

    return entries;
};

class Brands {
    constructor() {
        this.entries = parse();
    }

    suggest(current_brand) {
        const current_score = current_brand.score;

        return this.entries
            .filter((brand) => (brand.score > current_score));
    }
};

// "MAIN" SCRIPT - calls functions

const brands = new Brands();

let url = window.location.href;  // get url

// Call functions
let result = urlBrandDirect(url);
console.log("urlBrandDirect returned " + result);
if (result == -1) {
    result = titleBrand();
    console.log("titleBrand returned " + result);
}


// FUNCTIONS - used to figure out brand name for various cases

// returns score if matching brand found, otherwise -1
function urlBrandDirect(url) {
    const urlByPeriod = url.split(".");
    const urlName = urlByPeriod[1];  // TODO IMPROVE THIS METHOD

    const b = brands.entries;
    
    for (let i = 0; i < b.length; i++) {
        const name = b[i].name;
        if (urlName == name.toLowerCase()) {
            return b[i].score;
        }
    }

    return -1;
}

// returns score if matching brand found, otherwise -1
function titleBrand() {
    let title = document.title;

    if (!title) {
        return -1;
    }

    title = title.toLowerCase();    // format our title tag
    console.log("title = " + title);
    let words = title.split(" ");  // all words in title tag

    // currently - single-word case
    for (let i = 0; i < words.length; i++) {  // for each word in title
        for (const brand of brands.entries) {
            const name = brand.name;
            if (words[i] == name.toLowerCase()) {
                return brand.score;
            }
            console.log("no direct match found, trying slice method");
            let nameBySpace = name.split(" ");
            for(const nameSlice of nameBySpace){
                console.log("checking slice:" + nameSlice);
                if(words[i] == nameSlice){
                    console.log("——Match found! returning " + brand.score);
                    return brand.score;
                }
            }
        }
    }

    return -1;
}

/*
NOTES
THESE ARE SOME PROBLEMATIC BRANDS AND MIGHT NEED EDGE CASE
Case1 (url subset of name by spaces): Abercrombie & Fitch, Aldi Nord, ALdi South, A
Case2 (url subset of name, no spaces): BCBGMAXAZRIA
Case3 (url equal to name, no spaces): Dick's Sporting Goods
Case3 (url subset of name, special chars): Bloomingdale's

Approach 2 (url bad, use title tag):American Eagle,
*/

//TODO IMPLEMENT SMARTER LINK PARSING
/*
e.g Bananana Republic has www.
*/
